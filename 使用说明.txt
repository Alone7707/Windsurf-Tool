# Windsurf账号管理器 - 使用说明

## 功能特性

✅ 批量自动注册Windsurf账号
✅ 自动绕过Cloudflare人机验证（使用puppeteer-real-browser）
✅ 本地IMAP接收邮箱验证码
✅ 账号池本地管理（增删改查）
✅ 一键切换Windsurf账号
✅ 自动清除Windsurf配置和缓存

## 安装步骤

1. 安装依赖：
   npm install

2. 启动应用：
   npm start

3. 开发模式（带调试）：
   npm run dev

## 配置说明

### 1. 邮箱域名配置

在"配置"页面添加你的域名邮箱后缀，例如：
- example.com
- yourdomain.com

注册时会自动生成格式为 user_xxxxx@yourdomain.com 的邮箱

### 2. IMAP邮箱配置

配置用于接收验证码的邮箱IMAP信息：

**示例（QQ邮箱）：**
- IMAP服务器: imap.qq.com
- 端口: 993
- 邮箱账号: your@qq.com
- 密码: 授权码（不是QQ密码）

**示例（Gmail）：**
- IMAP服务器: imap.gmail.com
- 端口: 993
- 邮箱账号: your@gmail.com
- 密码: 应用专用密码

**示例（163邮箱）：**
- IMAP服务器: imap.163.com
- 端口: 993
- 邮箱账号: your@163.com
- 密码: 授权码

配置完成后点击"测试连接"验证配置是否正确。

## 使用流程

### 批量注册账号

1. 进入"配置"页面，设置好邮箱域名和IMAP配置
2. 进入"批量注册"页面
3. 设置注册数量（建议1-10个）
4. 点击"开始批量注册"
5. 等待自动注册完成（会自动处理Cloudflare验证）

### 注册流程详解

**步骤1: 填写基本信息**
- First name (自动填写)
- Last name (自动填写)
- Email (自动生成)
- 同意条款复选框
- 点击Continue按钮

**步骤2: 设置密码**
- Email (再次确认)
- Password (密码=邮箱地址)
- Password confirmation (确认密码)
- 点击Continue按钮

**步骤3: Cloudflare人机验证**
- 自动等待并通过验证
- 点击Continue按钮

**步骤4: 邮箱验证码**
- 自动接收6位验证码
- 自动输入验证码
- 点击Create account按钮

**步骤5: 完成注册**
- 账号自动保存到本地

### 管理账号

1. 进入"账号管理"页面
2. 查看所有已注册的账号
3. 查看账号统计信息:
   - 总账号数
   - 可用账号数
   - 即将到期账号数(≤3天)
   - 已到期账号数
4. 每个账号显示:
   - 邮箱地址
   - Pro状态徽章(剩余天数/已到期)
   - 创建时间
   - 到期时间(注册后13天)
5. 可以复制账号信息或删除账号
6. 也可以手动添加已有账号

**到期规则:**
- Pro试用期: 13天
- 剩余天数 > 3天: 绿色徽章
- 剩余天数 ≤ 3天: 橙色徽章(警告)
- 已到期: 红色徽章"已到期Pro"

### 切换账号(全自动)

1. 进入"切换账号"页面
2. 查看Windsurf配置路径检测结果
3. 从下拉列表选择要切换的账号
4. 点击"自动切换账号"
5. 系统自动执行以下步骤:
   - 步骤1: 完整重置Windsurf配置和机器码
   - 步骤2: 自动启动Windsurf应用
   - 步骤3: 自动登录选定的账号
   - 步骤4: 完成切换并返回Windsurf

**重置内容包括:**
- 删除所有缓存和临时数据
- 清除登录信息和会话数据
- 重置机器标识(machineId, sqmId, devDeviceId)
- 清除浏览历史和工作区数据
- 重置machineid文件

## 技术架构

- **前端框架**: Electron + HTML/CSS/JavaScript
- **浏览器自动化**: puppeteer-real-browser（自动绕过Cloudflare）
- **邮箱接收**: Node.js IMAP（本地实现）
- **数据存储**: JSON文件（本地存储）

## 核心技术点

1. **Cloudflare绕过**: 使用puppeteer-real-browser的turnstile功能自动点击人机验证
2. **本地IMAP**: 在Electron主进程中实现IMAP邮件接收，无需后端服务器
3. **完整重置**: 删除所有缓存、配置、会话数据,重置机器码
4. **机器码重置**: 重新生成machineId、sqmId、devDeviceId、machineid
5. **自动登录**: 使用AppleScript在Windsurf应用内部模拟键盘输入
6. **账号隔离**: 每次切换账号都完全重置,确保账号独立性
7. **到期管理**: 自动计算Pro试用期(13天),实时显示剩余天数

## 注意事项

⚠️ 批量注册时建议间隔5-10秒，避免被检测
⚠️ 切换账号会清除所有Windsurf配置，请提前备份重要数据
⚠️ IMAP密码通常是授权码，不是邮箱登录密码
⚠️ 确保配置的域名邮箱能够接收到Windsurf的验证邮件

## 常见问题

Q: Cloudflare验证失败怎么办？
A: puppeteer-real-browser会自动处理，如果失败请检查网络连接

Q: 收不到验证码？
A: 检查IMAP配置是否正确，使用"测试连接"功能验证

Q: 账号数据存储在哪里？
A: 存储在应用数据目录的accounts.json文件中

Q: 如何备份账号？
A: 复制应用数据目录中的accounts.json文件

Q: 自动登录失败怎么办？
A: 
1. 确保Windsurf已完全启动并显示登录界面
2. 检查系统是否允许AppleScript控制(系统偏好设置 > 安全性与隐私 > 辅助功能)
3. 手动在Windsurf中点击登录界面,确保光标在邮箱输入框
4. 如果自动登录失败,会显示账号密码供手动输入

Q: 为什么要等待8秒？
A: Windsurf启动需要时间加载登录界面,8秒是为了确保界面完全加载

## Windsurf配置路径（macOS）

- 配置目录: ~/Library/Application Support/Windsurf
- 缓存目录: ~/Library/Caches/Windsurf

## 开发者信息

本工具完全本地运行，不依赖任何后端服务器。
所有数据均存储在本地，保护隐私安全。
